"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const service_1 = require("../service");
const common = tslib_1.__importStar(require("@protocolink/common"));
const fs_extra_1 = tslib_1.__importDefault(require("fs-extra"));
const configs_1 = require("../configs");
const path_1 = require("path");
async function default_1() {
    for (const chainId of configs_1.supportedChainIds) {
        const markets = (0, configs_1.getMarkets)(chainId);
        const service = new service_1.Service(chainId);
        const tokenMap = {};
        for (const market of markets) {
            const { cToken, baseToken } = await service.getCometTokens(market.id);
            tokenMap[cToken.symbol] = cToken;
            tokenMap[baseToken.symbol] = baseToken;
            if (baseToken.isWrapped) {
                const unwrappedBaseToken = baseToken.unwrapped;
                tokenMap[unwrappedBaseToken.symbol] = unwrappedBaseToken;
            }
            const collaterals = await service.getCollaterals(market.id);
            for (const collateral of collaterals) {
                tokenMap[collateral.symbol] = collateral;
            }
        }
        const tokenDataPath = (0, path_1.resolve)(__dirname, '..', 'tokens', 'data', `${common.toNetworkId(chainId)}.json`);
        fs_extra_1.default.outputJSONSync(tokenDataPath, tokenMap, { spaces: 2 });
    }
}
exports.default = default_1;
//# sourceMappingURL=refresh-tokens-data.js.map